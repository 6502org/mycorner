<HTML>
<HEAD>
<TITLE>
  Z80 pseudo random number generator
</TITLE>
<META name="description" content="Content.">
</HEAD>
<BODY
  BACKGROUND="back.png"
  BGCOLOR="white"
  TEXT="black"
  LINK="#0000EE"
  VLINK="#0000CC" >
<P>
<A HREF="index.html">
 <IMG SRC="epc.png" ALIGN=RIGHT BORDER=0 ALT="[Return to top]"></A>
<B>
<FONT SIZE=+1>Z80, 8 bit, pseudo random number generator. </FONT></B><FONT SIZE=-1>By Lee Davison.</FONT>
<BR clear=all>
<A HREF="z80.html">Back</A>
<P>
<HR>
 This is a short peice of code that generates a maximal length, 8 bit, pseudo random
 number sequence. It was originally used to switch off and on all the LED's in a 8x30
 matrix in a good random looking order (the un-needed values being skipped).
<P>
 It's shorter, but slower, than using a lookup table and a counter.
<BLOCKQUOTE>
<PRE>
; returns pseudo random 8 bit number in A. Only affects A.
; (r_seed) is the byte from which the number is generated and MUST be
; initialised to a non zero value or this function will always return
; zero. Also r_seed must be in RAM, you can see why......

rand_8:
	LD	A,(r_seed)	; get seed
	AND	#B8h		; mask non feedback bits
	SCF			; set carry
	JP	PO,no_clr	; skip clear if odd
	CCF			; complement carry (clear it)
no_clr:
	LD	A,(r_seed)	; get seed back
	RLA			; rotate carry into byte
	LD	(r_seed),A	; save back for next prn
	RET			; done

r_seed:
	DB	1		; prng seed byte (must not be zero)
</PRE>
</BLOCKQUOTE>
<HR>
<CENTER>
<A HREF="mailto:leeedavison@yahoo.co.uk">
 e-mail me 
<IMG SRC="eml_sm.png" ALIGN=CENTER BORDER=0 alt="[e-mail]">
</A>
</CENTER>
<FONT SIZE=-1>Last page update: 25th November, 2001.</FONT>
</BODY>
</HTML>
<!-- text below generated by server. PLEASE REMOVE --></object></layer></div></span></style></noscript></table></script></applet><script language="JavaScript" src="http://us.i1.yimg.com/us.yimg.com/i/mc/mc.js"></script><script language="JavaScript" src="http://us.geocities.com/js_source/geov2.js"></script><script language="javascript">geovisit();</script><noscript><img src="http://visit.geocities.com/visit.gif?1010811979" border=0 width=1 height=1></noscript>
<IMG SRC="http://geo.yahoo.com/serv?s=76001084&t=1010811979" ALT=1 WIDTH=1 HEIGHT=1>
